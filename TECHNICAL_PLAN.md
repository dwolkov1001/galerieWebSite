# Технический план реализации проекта «Галерея изображений»

---

## Этап 1. Инициализация проекта и базовая структура `[ЗАВЕРШЁН]`

**Шаг 1.1:** Создать структуру папок и файлов проекта (см. TDD_SPEC.md, раздел 6). `[ВЫПОЛНЕНО]`
**Шаг 1.2:** Настроить виртуальное окружение и файл requirements.txt (Flask, SQLite, etc.). `[ВЫПОЛНЕНО]`
**Шаг 1.3:** Создать пустую базу данных и таблицу `images`. `[ВЫПОЛНЕНО]`
**Шаг 1.4:** Создать базовые шаблоны HTML (index.html, upload.html). `[ВЫПОЛНЕНО]`

---

## Этап 2. Загрузка изображений `[ЗАВЕРШЁН]`

**Шаг 2.1:** Реализовать форму загрузки изображения (upload.html). `[ВЫПОЛНЕНО]`
**Шаг 2.2:** Реализовать backend-логику загрузки файла (ограничения по размеру и формату). `[ВЫПОЛНЕНО]`
**Шаг 2.3:** Сохранять файл на диск и информацию о нём в базу данных. `[ВЫПОЛНЕНО]`
**Шаг 2.4:** Реализовать обработку ошибок (размер, формат, вредоносные файлы). `[ВЫПОЛНЕНО]`
**Шаг 2.5:** Реализовать редирект на главную страницу после успешной загрузки. `[ВЫПОЛНЕНО]`
**Шаг 2.6:** Написать и запустить тесты для загрузки изображений (см. TDD_SPEC.md, 5.1, 5.4). `[ВЫПОЛНЕНО]`

---

## Этап 3. Отображение галереи `[ЗАВЕРШЁН]`

**Шаг 3.1:** Реализовать вывод всех изображений из базы на главной странице (index.html). `[ВЫПОЛНЕНО]`
**Шаг 3.2:** Оформить сетку изображений с помощью CSS. `[ВЫПОЛНЕНО]`
**Шаг 3.3:** Реализовать отображение подписей к изображениям. `[ВЫПОЛНЕНО]`
**Шаг 3.4:** Реализовать сообщение «Нет изображений», если база пуста. `[ВЫПОЛНЕНО]`
**Шаг 3.5:** Написать и запустить тесты для отображения галереи (см. TDD_SPEC.md, 5.2). `[ВЫПОЛНЕНО]`

---

## Этап 4. Система тем `[ЗАВЕРШЁН]`

**Шаг 4.1:** Создать CSS переменные для цветов светлой и тёмной тем. `[ВЫПОЛНЕНО]`
**Шаг 4.2:** Реализовать стили для тёмной темы с помощью data-theme="dark". `[ВЫПОЛНЕНО]`
**Шаг 4.3:** Добавить переключатель темы в header всех страниц. `[ВЫПОЛНЕНО]`
**Шаг 4.4:** Создать JavaScript для переключения тем и сохранения в localStorage. `[ВЫПОЛНЕНО]`
**Шаг 4.5:** Добавить плавные переходы между темами (CSS transitions). `[ВЫПОЛНЕНО]`
**Шаг 4.6:** Написать и запустить тесты для системы тем (см. TDD_SPEC.md, 5.5). Тесты проведены вручную, система тем работает корректно.

---

## Этап 5. Удаление изображений

**Шаг 5.1:** Добавить кнопку «Удалить» для каждого изображения. `[ВЫПОЛНЕНО]`
**Шаг 5.2:** Реализовать backend-логику удаления файла с диска и записи из базы. `[ВЫПОЛНЕНО]`
**Шаг 5.3:** Реализовать обработку ошибок при удалении (несуществующий файл и др.). `[ВЫПОЛНЕНО]`
**Шаг 5.4:** Реализовать редирект на главную после удаления. `[ВЫПОЛНЕНО]`
**Шаг 5.5:** Написать и запустить тесты для удаления изображений (см. TDD_SPEC.md, 5.3).

---

## Этап 6. UI/UX и нефункциональные требования

**Шаг 6.1:** Оформить адаптивную сетку изображений. `[ВЫПОЛНЕНО]`
**Шаг 6.2:** Добавить сообщения об ошибках и успехе. `[ВЫПОЛНЕНО]`
**Шаг 6.3:** Проверить ограничения по размеру и формату файлов. `[ВЫПОЛНЕНО]`
**Шаг 6.4:** Проверить безопасность путей и загрузки файлов (см. TDD_SPEC.md, 5.4). `[ВЫПОЛНЕНО]`

---

## Этап 7. Дополнительные функции (по желанию)

**Шаг 7.1:** Реализовать аутентификацию и регистрацию пользователей (многопользовательский режим, безопасность).
    - **7.1.1:** Добавить таблицу пользователей (id, username, email, password_hash) и user_id в таблицу изображений. `[ВЫПОЛНЕНО]`
    - **7.1.2:** Реализовать страницу регистрации (логин, email (необязательно), пароль, подтверждение пароля). Пароли хранятся в виде хэша. `[ВЫПОЛНЕНО]`
    - **7.1.3:** Реализовать вход/выход (сессии, проверка пароля по хэшу). `[ВЫПОЛНЕНО]`
    - **7.1.4:** Хранить секретный ключ Flask и параметры БД в .env (использовать python-dotenv). `[ВЫПОЛНЕНО]`
    - **7.1.5:** Только авторизованный пользователь может загружать/удалять изображения. Каждый видит только свои изображения. `[ВЫПОЛНЕНО]`
    - **7.1.6:** Реализовать восстановление пароля через email (отправка ссылки, установка нового пароля). `[РЕАЛИЗОВАНО В КОДЕ, SMTP не настраивался]`
    - **7.1.7:** Весь интерфейс и сообщения — на английском языке. `[ВЫПОЛНЕНО]`
    - **7.1.8:** Обновить шаблоны: статус пользователя, выход, ссылки на регистрацию/вход, сообщения об ошибках/успехе. `[ВЫПОЛНЕНО]`
**Шаг 7.2:** Реализовать просмотр изображения на отдельной странице.
    - **7.2.1:** Добавить маршрут и шаблон для просмотра изображения по id. `[ВЫПОЛНЕНО]`
    - **7.2.2:** На отдельной странице показывать увеличенное изображение, подпись, дату, владельца. `[ВЫПОЛНЕНО]`
    - **7.2.3:** Кнопка удаления (только для владельца). `[ВЫПОЛНЕНО]`
    - **7.2.4:** Ссылка «назад к галерее». `[ВЫПОЛНЕНО]`
**Шаг 7.3:** Реализовать пагинацию галереи. `[ВЫПОЛНЕНО]`
    - **7.3.1:** Добавить параметры страницы в маршрут главной страницы. `[ВЫПОЛНЕНО]`
    - **7.3.2:** Реализовать выборку изображений для текущей страницы в backend. `[ВЫПОЛНЕНО]`
    - **7.3.3:** Добавить навигацию по страницам в шаблон галереи. `[ВЫПОЛНЕНО]`
    - **7.3.4:** Проверить работу пагинации. `[ВЫПОЛНЕНО]`

